# Portfolio (final version)

My online business card and portfolio of my featured development projects. Live at [helenmckay.dev](https://helenmckay.dev). 

## How it's made

React application with Firebase back-end. 

Browser Router and custom protected routes used for routing. Page components are lazy loaded using React.lazy() and Suspense. State is managed with Hooks, including `react-firebase-hooks`.

Firebase used for user authentication, image storage (Firebase Storage), database (Firebase Firestore), and hosting. 

## Cool features

Logging in as an authenticated user grants me access to the Admin page. There, I can view, update, or delete the portfolio cards, as well as create new cards. These cards are stored in Firestore. Images associated with portfolio cards are stored in Firebase Storage.

In other words, this application is fully CRUD. I can manage everything in the application's Firebase Firestore and Storage purely from the application front-end without ever logging in to the Firebase console.

## Featured Code

The bulk of the application logic can be found in `AdminCard.js`. 

Here's some featured snippets from `AdminCard.js`:

### Checking if the card has an image associated with it in Storage

`doc_id` is the key auto-generated by Firestore when a new card is created. A card's `doc_id` is used to name the image uploaded to the card. Images are stored at route `/doc_id/doc_id.jpg` in Firebase Storage. Firebase Storage does not have folder objects. However, you can use the `.listAll()` function on a route to list all the files at that route as if it was a directory. I use this to check if a card has an associated image. Checking for existence is crucial to preventing Storage functions errors (Storage functions assume existence).

```
const AdminCard = ({doc_id, data, updateCard, deleteCard}) => {
    const [hasImage, setHasImage] = useState(false);

    useEffect(() => {
        async function checkForImage(){
            const result = await firebase.storage().ref(`projects/${doc_id}`).listAll();

            if (result.items.length > 0)
            {
                setHasImage(true);
            }
        };

        checkForImage();
    }, [doc_id])
    
    ...
```

### If an AdminCard has an associated image, then display that image

AdminCard renders AdminCardImageFetcher component, passing along doc_id.

```
 {hasImage && <AdminCardImageFetcher doc_id={doc_id}/>}
```

AdminCardImageFetcher component uses `useDownloadURL` Hook from `react-firebase-hooks` to get the download URL of the image from Storage. Errors are prevented because the image's existence has already been verified and thus `useDownloadURL` always receives a valid Storage path.

```
const AdminCardImageFetcher = (props) => {
    const [downloadURL, URL_loading, ,] = useDownloadURL(
        firebase.storage().ref(`projects/${props.doc_id}/${props.doc_id}.jpg`)
    );

    return(
        <div className="pic_container">
            {URL_loading ?
            <p>Loading image...</p>
            :<img src={downloadURL} alt=""/>}
        </div>
    )
}
```
    
